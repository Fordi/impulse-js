/* impulse-js 2014-02-08 */
var iMpulse=function(){"use strict";function a(a,b,c){var d,e;if(f[a])for(d in f[a])if(f[a].hasOwnProperty(d)&&(e=f[a][d],!1===e[1].call(e[0],b,c,new Date)))return!1}function b(){if(!g.length&&e.pollingHandle)return clearInterval(e.pollingHandle),void(e.pollingHandle=null);var a,b,c=g.flushEvents();for(a=0;a<c.length;a+=1)c[a].impliedMode&&e.state.mode!==c[a].impliedMode&&(e.state.mode=c[a].impliedMode,b=!0),c[a].handedness&&e.state.handedness!==c[a].handedness&&(e.state.handedness=c[a].handedness,b=!0),c[a].player&&e.state.player!==c[a].player&&(e.state.player=c[a].player,b=!0),b&&e.trigger("MODE","SET"),"UP"===c[a].event&&delete e.state[c[a].key],"DOWN"===c[a].event&&(e.state[c[a].key]=!0),e.trigger(c[a].key,c[a].event,+new Date)}function c(a){g.addEvent(a),e.pollingHandle||(e.pollingHandle=setInterval(b,33))}var d={mode:null},e={state:d,handedness:"RIGHT",player:"P1"},f={},g=null;return e.state={mode:null},e.init=function(){g||(g=new e.Stream,e.start())},e.on=function(a,b,c,d){d||(d=c,c=window);var e=a.toLowerCase()+":"+b.toLowerCase();f[e]||(f[e]={}),f[e][d]=[c,d]},e.off=function(a,b,c){var d=a.toLowerCase()+":"+b.toLowerCase();c?delete f[d][c]:f[d]={}},e.trigger=function(b,c,d){var e=b.toLowerCase()+":"+c.toLowerCase();d=d||+new Date,!1!==a(e,b,c,d)&&!1!==a("any:"+c,b,c,d)&&!1===a("any:any",b,c,d)},e.start=function(){window.jQuery(window).on("keyup keydown",c)},e.stop=function(){window.jQuery(window).off("keyup keydown",c)},e}();!function(a){"use strict";a.sequences={d16d51d54d50d220u16u51u54u50u220:["MODE","SET","UNIVERSAL","RIGHT","P1"],d16d51d54d49d220u16u51u54u49u220:["MODE","SET","UNIVERSAL","RIGHT","P2"],d16d51d53d50d220u16u51u53u50u220:["MODE","SET","UNIVERSAL","LEFT","P1"],d16d51d53d49d220u16u51u53u49u220:["MODE","SET","UNIVERSAL","LEFT","P2"],d16d55d54d50d220u16u55u54u50u220:["MODE","SET","MEDIA"],d16d52d54d50d220u16u52u54u50u220:["MODE","SET","IOS"],d16d56d54d50d220u16u56u54u50u220:["MODE","SET","TV"],d177:["REV","DOWN"],u177:["REV","UP"],d176:["FWD","DOWN"],u176:["FWD","UP"],d16d37:["SCROLL<","DOWN"],u16u37:["SCROLL<","UP"],d16d39:["SCROLL>","DOWN"],u16u39:["SCROLL>","UP"],d38:["UP","DOWN"],u38:["UP","UP"],d37:["LEFT","DOWN"],u37:["LEFT","UP"],d39:["RIGHT","DOWN"],u39:["RIGHT","UP"],d40:["DOWN","DOWN"],u40:["DOWN","UP"],d65:["A","DOWN"],u65:["A","UP"],d87:["W","DOWN"],u87:["W","UP"],d86:["V","DOWN"],u86:["V","UP"],d77:["M","DOWN"],u77:["M","UP"],d78:["N","DOWN"],u78:["N","UP"],d85:["U","DOWN"],u85:["U","UP"],d27:["ESC","DOWN"],u27:["ESC","UP"],d13:["ENTER","DOWN"],u13:["ENTER","UP"],d179:["PLAY","DOWN"],u179:["PLAY","UP"],d173:["MUTE","DOWN"],u173:["MUTE","UP"],d175:["VOL+","DOWN"],u175:["VOL+","UP"],d174:["VOL-","DOWN"],u174:["VOL-","UP"]}}(this.iMpulse),function(a){"use strict";a.PadEvent=function(a){this.key=a[0],this.event=a[1],this.impliedMode=a[2],this.handedness=a[3],this.player=a[4]}}(this.iMpulse),function(a){"use strict";a.Signal=function(a){"keydown"===a.type&&(this.pressed=!0),this.keyCode=a.keyCode,this.srcEvent=a},a.Signal.prototype.toString=function(){return(this.pressed?"d":"u")+String(this.keyCode)}}(this.iMpulse),function(a){"use strict";function b(){this.state={}}b.prototype=[],b.prototype.addEvent=function(b){this.push(new a.Signal(b))},b.prototype.toString=function(){var a,b,c=[],d=window.jQuery.extend({},this.state);for(a=0;a<this.length;a+=1)b=this[a].keyCode,!!this[a].pressed!=!!d[b]&&(d[b]=this[a].pressed,c.push(this[a].toString()));return c.join("")},b.prototype.flushEvents=function(){var b,c,d,e=[],f=this.toString();a:for(;f.length;){for(b in a.sequences)if(a.sequences.hasOwnProperty(b)&&f.substr(0,b.length)===b){e.push(new PadEvent(a.sequences[b])),f=f.substr(b.length);continue a}if(c=f.match(/^([ud])(\d+)/),!c)throw new Error("Weird stuff in the event stream: "+f);f=f.substr(c[0].length)}for(d=0;d<this.length;d+=1)this.state[this[d].keyCode]=this[d].pressed;return this.length=0,e}}(this.iMpulse),function(a){"use strict";a.init()}(this.iMpulse);